app = "gay-minecraft"
primary_region = "atl"

[build]
    image = "itzg/minecraft-server:java17-alpine"

[env]
    TYPE = "FORGE"
    VERSION = "1.19.2"
    FORGE_VERSION = "43.2.14"
    EULA = "true"
    # modpack config
    GENERIC_PACK = "https://freedman.dev/minecraft/Magic_Mods_Amaya_Likes__Automat-the_fourth_one__SERVER.zip"
    # min heap size of 512MB, max of 3GB
    INIT_MEMORY = "512M"
    MAX_MEMORY = "3G"
    # autostop kills the server after no one has connected for a configured
    # amount of time. while this ACTUALLY turns off the underlying Fly Machine,
    # the config in [[services]] will turn it back on when someone connects
    ENABLE_AUTOSTOP = "TRUE"
    AUTOSTOP_TIMEOUT_EST = "10" # TODO: increase to 3600 seconds (1 hour)
    AUTOSTOP_TIMEOUT_INIT = "10" # TODO: increase to 3600 seconds (1 hour)
    AUTOSTOP_PERIOD = "1" # TODO: increase to 10 seconds
    DEBUG_AUTOSTOP = "TRUE"
    # prevents logs from building up indefinitely
    ENABLE_ROLLING_LOGS = "true"
    # MC Server config
    MODE = "survival"
    SERVER_NAME = "gay_minecraft"
    MOTD = "gay minecraft"
    DIFFICULTY = "easy"
    SEED = "gay minecraft"
    LEVEL = "gay_minecraft_v2"
    # Operator/admin config
    OVERRIDE_OPS = "true"
    OPS_FILE = "https://freedman.dev/minecraft/ops.json"
    # Whitelist config
    OVERRIDE_WHITELIST = "true"
    ENABLE_WHITELIST = "true"
    ENFORCE_WHITELIST = "true"
    WHITELIST_FILE = "https://freedman.dev/minecraft/whitelist.json"

[mounts]
    source = "mc_data"
    destination = "/data"

[[services]]
    internal_port = 25565
    protocol = "tcp"
    ports = { port = 25565 }
    auto_stop_machines = false
    auto_start_machines = true
    min_machines_running = 0
    concurrency = { type = "connections", hard_limit = 25, soft_limit = 20 }
